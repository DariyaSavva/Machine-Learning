Важно!!! последнее 7 домашнее задание лежит в файле Clusterization.ipynb, а 3 домашнее задание в файле Dataset_Restaurant.ipynb
# Machine-Learning. Практические работы по спецкурсу "Машинное обучение"

### Описание задачи, выполняемой над датасетом

**Задача:** Прогнозирование выручки ресторана (Restaurant Revenue Prediction).

**Описание:** Задача представляет собой **задачу регрессии**. Цель — на основе характеристик ресторана (как числовых, так и категориальных) построить модель, которая сможет предсказать его годовую выручку (`Revenue`), которая является непрерывной числовой величиной.

**Используемые признаки (Features):**

*Числовые:*
- Вместимость (`Seating Capacity`)
- Средняя цена блюда (`Average Price per Meal`) 
- Маркетинговый бюджет (`Marketing Spend`)
- Количество подписчиков в соцсетях (`Social Media Followers`)
- Рейтинг (`Rating`)
- Оценка атмосферы (`Ambiance Rating`)
- Оценка обслуживания (`Service Rating`)
- Количество бронирований на будни/выходные (`Weekday Bookings`, `Weekend Bookings`)

*Категориальные:*
- Местоположение (`Location`)
- Тип кухни (`Cuisine`) 
- Наличие парковки (`Parking Availability`)

**Практическая значимость:** Решение такой задачи позволяет:

1. **Владельцам и инвесторам** оценить потенциальную доходность нового ресторана на этапе планирования
2. **Выявить ключевые факторы**, наиболее сильно влияющие на финансовый успех заведения (например, вместимость и ценовая политика, как показал анализ корреляции)
3. **Провести бенчмаркинг** существующих ресторанов и определить точки роста для увеличения их выручки

### Обоснование выбора метода решения

В данной работе решается задача регрессии, так как целевая переменная Revenue (выручка ресторана) является непрерывной числовой величиной.
Следовательно, методы классификации неприменимы, а задача сводится к построению модели, способной предсказывать количественное значение на основе набора признаков.

Линейная регрессия была выбрана в качестве основного метода по следующим причинам:

1. **Результаты предварительного анализа данных**  
Предварительный анализ показал наличие выраженных линейных зависимостей между целевой переменной и рядом признаков. В частности, наблюдается высокая положительная корреляция выручки с такими параметрами, как вместимость ресторана, средняя цена блюда, маркетинговый бюджет и количество подписчиков в социальных сетях. Линейная регрессия хорошо подходит для моделирования подобных зависимостей и позволяет эффективно использовать выявленные корреляционные связи.

2. **Интерпретируемость результатов**  
Линейная регрессия является интерпретируемой моделью, что позволяет количественно оценить вклад каждого признака в формирование итоговой выручки. Это особенно важно в рамках бизнес-задачи, где требуется не только получение предсказаний, но и понимание факторов, влияющих на доход ресторана.

3. **Структура исходных данных**  
В наборе данных присутствует значительное количество числовых признаков, а категориальные признаки были преобразованы в числовой формат с помощью One-Hot Encoding. После кодирования и стандартизации признаков линейная регрессия может быть напрямую применена к полученному признаковому пространству без необходимости использования дополнительных сложных преобразований.

4. **Стабильность обучения и контроль переобучения**  
Линейная регрессия является устойчивым методом с низким риском переобучения при достаточном объёме данных. Близкие значения ошибки на обучающей и тестовой выборках свидетельствуют о хорошей обобщающей способности модели и корректности выбранного подхода.



## Метрики качества модели

Для оценки качества построенной регрессионной модели использовались две метрики: RMSE (Root Mean Squared Error) и R² (коэффициент детерминации).
Это позволяет оценить модель как с точки зрения абсолютной величины ошибки, так и с точки зрения способности объяснять вариативность целевой переменной.

### Метрика RMSE

Метрика RMSE определяется формулой:

$$
RMSE = \sqrt{\frac{1}{n}\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}
$$

где:

- $y_i$ — истинное значение выручки ресторана,
- $\hat{y}_i$ — предсказанное моделью значение,
- $n$ — количество объектов.

RMSE измеряется в тех же единицах, что и целевая переменная (рубли), и показывает **среднюю величину ошибки предсказания**.

Значения RMSE составили:

- Обучающая выборка: 54 429 руб.
- Тестовая выборка: 55 891 руб.

Это означает, что средняя ошибка предсказания выручки ресторана составляет около 55 000 рублей, что примерно соответствует 8–9% от среднего уровня дохода.
Небольшая разница между RMSE на обучающей и тестовой выборках указывает на отсутствие переобучения и на хорошую обобщающую способность модели.

**RMSE используется как основная метрика качества, так как она позволяет оценить величину ошибки предсказаний в абсолютных единицах и имеет прямую интерпретацию в контексте бизнес-задачи;**



### Метрика R²


Метрика R² вычисляется по формуле:

$$
R^2 = 1 - \frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{\sum_{i=1}^{n}(y_i - \bar{y})^2}
$$

где:

- $y_i$ — истинное значение выручки,
- $\hat{y}_i$ — предсказанное значение,
- $\bar{y}$ — среднее значение выручки по выборке.

Метрика R² показывает **долю дисперсии целевой переменной, объяснённую моделью**. Она отражает, насколько хорошо модель описывает различия в выручке между ресторанами по сравнению с наивным прогнозом, в котором всегда предсказывается среднее значение целевой переменной.

В данной работе получены значения:

- Обучающая выборка: `0.9585`
- Тестовая выборка: `0.9565`

Это означает, что модель объясняет около 95–96% вариативности выручки ресторанов. Близость значений на обучающей и тестовой выборках свидетельствует о стабильности модели и отсутствии переобучения.


**Несмотря на высокую информативность, R² не отражает абсолютную величину ошибки и не имеет прямой интерпретации в рублях, поэтому используется вспомогательной метрикой, дополняющей основную оценку качества модели.**

### Общие выводы

В ходе анализа данных и построения модели прогнозирования выручки ресторанов были сделаны следующие ключевые выводы:

**По данным:**
- Выборка хорошо сбалансирована по географическому признаку и типам кухонь
- Центральные локации (Downtown) преобладают (33.7% ресторанов), что логично для ресторанного бизнеса
- Наиболее распространенная кухня - французская (17.1% ресторанов)
- Наличие парковки распределено практически равномерно (50.1% с парковкой vs 49.9% без)

**По корреляционному анализу:**
- Наибольшая положительная корреляция с выручкой наблюдается у **вместимости ресторана** и **средней цены блюда**
- Значимая положительная корреляция также обнаружена с маркетинговым бюджетом, количеством подписчиков в соцсетях и бронированиями
- Параметры с незначительным влиянием на выручку: рейтинг, оценки атмосферы и обслуживания
- Значительной отрицательной корреляции с выручкой не выявлено

**По географическому распределению:**
- Наиболее прибыльными являются рестораны в центре города
- Наименее прибыльные - рестораны в сельской местности

**По построенной модели:**
- Линейная регрессия показала хорошую сходимость результатов на обучающей и тестовой выборках
- Незначительное превышение ошибки на тестовой выборке свидетельствует об отсутствии переобучения
- Модель адекватно описывает зависимость выручки от характеристик ресторана

**Рекомендации:**
Для максимизации выручки ресторана следует уделять внимание увеличению вместимости заведения и формированию грамотной ценовой политики, при этом предпочтительнее выбирать локации в центре города.
